<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd"
        objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS">
    <changeSet id="1" author="offer">
        <createTable tableName="CONTRACT_SUBTYPE">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_CONTRACT_SUBTYPE"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="2" author="offer">
        <createTable tableName="COVERAGE_CLASS">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_COVERAGE_CLASS"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="3" author="offer">
        <createTable tableName="INSURANT">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_INSURANT"/>
            </column>
            <column name="SHORT_NAME" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="4" author="offer">
        <createTable tableName="OFFER">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_OFFER"/>
            </column>
            <column name="NUMBER_CONTRACT" type="VARCHAR(255)"/>
            <column name="PARTNER_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
            <column name="INSURANT_ID" type="UUID"/>
            <column name="CONTRACT_FORM" type="VARCHAR(255)"/>
            <column name="MISS_DUPLICATE_MESSAGE_FOR_NUMBER_CONTRACT" type="BOOLEAN"/>
            <column name="CONTRACT_TYPE" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="OPTIONAL_ATTRIBUTE" type="BOOLEAN"/>
            <column name="GENERAL_CONTRACT_WITH_DECLARATIONS" type="BOOLEAN"/>
            <column name="ACCOUNT_BY_REINSURERS" type="BOOLEAN"/>
            <column name="CONTRACT_SUBTYPE_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
            <column name="COVERAGE_CLASS_ID" type="UUID">
                <constraints nullable="false"/>
            </column>
            <column name="OBLIG_CESSION" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="OBLIG_CESSION_PRECENT" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="IS_LIST_OF_REINSURERS" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="REINSURER_TYPE_ID" type="UUID"/>
            <column name="POOL_OF_REINSURERS_ID" type="UUID"/>
            <column name="BORDEURO_CALCULATIONS" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="SHARE_" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="RETROCESSION" type="BOOLEAN"/>
            <column name="START_DATE_INSURANCE" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="END_DATE_INSURANCE" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="PERIOD_INSURANCE" type="DECIMAL(19)"/>
            <column name="START_DATE_REINSURANCE" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="END_DATE_REINSURANCE" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="PERIOD_REINSURANCE" type="DECIMAL(19)"/>
            <column name="EMAIL_CONTACT" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="EMAIL_REINSURER" type="VARCHAR(255)"/>
            <column name="SIGNING_FORM" type="VARCHAR(255)"/>
            <column name="NAME_OF_SIGNER_FROM_PARTNER_ID" type="UUID"/>
            <column name="PRIMARY_INSURANT_ID" type="UUID"/>
        </createTable>
    </changeSet>
    <changeSet id="5" author="offer">
        <createTable tableName="OFFER_REINSURER_LINK">
            <column name="OFFER_ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_OFFER_REINSURER_LINK"/>
            </column>
            <column name="REINSURER_ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_OFFER_REINSURER_LINK"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="6" author="offer">
        <createTable tableName="PARTNER">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_PARTNER"/>
            </column>
            <column name="PARTNER_NAME" type="VARCHAR(255)"/>
            <column name="PARTNER_INN" type="VARCHAR(255)"/>
            <column name="PARTNER_OGRN" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="7" author="offer">
        <createTable tableName="POOL_OF_REINSURERS">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_POOL_OF_REINSURERS"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="8" author="offer">
        <createTable tableName="PRIMARY_INSURANT">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_PRIMARY_INSURANT"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="9" author="offer">
        <createTable tableName="REINSURER">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_REINSURER"/>
            </column>
            <column name="PARTNER_NAME" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="10" author="offer">
        <createTable tableName="REINSURER_TYPE">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_REINSURER_TYPE"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="11" author="offer">
        <createTable tableName="SIGNER">
            <column name="ID" type="UUID">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_SIGNER"/>
            </column>
            <column name="FULLNAME" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="12" author="offer">
        <createIndex indexName="IDX_OFFER_INSURANT" tableName="OFFER">
            <column name="INSURANT_ID"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="INSURANT_ID" baseTableName="OFFER"
                                 constraintName="FK_OFFER_ON_INSURANT" referencedColumnNames="ID"
                                 referencedTableName="INSURANT"/>
    </changeSet>
    <changeSet id="13" author="offer">
        <createIndex indexName="IDX_OFFER_NAME_OF_SIGNER_FROM_PARTNER" tableName="OFFER">
            <column name="NAME_OF_SIGNER_FROM_PARTNER_ID"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="NAME_OF_SIGNER_FROM_PARTNER_ID" baseTableName="OFFER"
                                 constraintName="FK_OFFER_ON_NAME_OF_SIGNER_FROM_PARTNER" referencedColumnNames="ID"
                                 referencedTableName="SIGNER"/>
    </changeSet>
    <changeSet id="14" author="offer">
        <createIndex indexName="IDX_OFFER_PARTNER" tableName="OFFER">
            <column name="PARTNER_ID"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="PARTNER_ID" baseTableName="OFFER" constraintName="FK_OFFER_ON_PARTNER"
                                 onDelete="CASCADE" referencedColumnNames="ID" referencedTableName="PARTNER"/>
    </changeSet>
    <changeSet id="15" author="offer">
        <createIndex indexName="IDX_OFFER_POOL_OF_REINSURERS" tableName="OFFER">
            <column name="POOL_OF_REINSURERS_ID"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="POOL_OF_REINSURERS_ID" baseTableName="OFFER"
                                 constraintName="FK_OFFER_ON_POOL_OF_REINSURERS" referencedColumnNames="ID"
                                 referencedTableName="POOL_OF_REINSURERS"/>
    </changeSet>
    <changeSet id="16" author="offer">
        <createIndex indexName="IDX_OFFER_REINSURER_TYPE" tableName="OFFER">
            <column name="REINSURER_TYPE_ID"/>
        </createIndex>

        <addForeignKeyConstraint baseColumnNames="REINSURER_TYPE_ID" baseTableName="OFFER"
                                 constraintName="FK_OFFER_ON_REINSURER_TYPE" referencedColumnNames="ID"
                                 referencedTableName="REINSURER_TYPE"/>
    </changeSet>
    <changeSet id="17" author="offer">
        <addForeignKeyConstraint baseColumnNames="CONTRACT_SUBTYPE_ID" baseTableName="OFFER"
                                 constraintName="FK_OFFER_ON_CONTRACT_SUBTYPE" referencedColumnNames="ID"
                                 referencedTableName="CONTRACT_SUBTYPE"/>
    </changeSet>
    <changeSet id="18" author="offer">
        <addForeignKeyConstraint baseColumnNames="COVERAGE_CLASS_ID" baseTableName="OFFER"
                                 constraintName="FK_OFFER_ON_COVERAGE_CLASS" referencedColumnNames="ID"
                                 referencedTableName="COVERAGE_CLASS"/>
    </changeSet>
    <changeSet id="19" author="offer">
        <addForeignKeyConstraint baseColumnNames="PRIMARY_INSURANT_ID" baseTableName="OFFER"
                                 constraintName="FK_OFFER_ON_PRIMARY_INSURANT" referencedColumnNames="ID"
                                 referencedTableName="PRIMARY_INSURANT"/>
    </changeSet>
    <changeSet id="20" author="offer">
        <addForeignKeyConstraint baseColumnNames="OFFER_ID" baseTableName="OFFER_REINSURER_LINK"
                                 constraintName="FK_OFFREI_ON_OFFER" referencedColumnNames="ID"
                                 referencedTableName="OFFER"/>
    </changeSet>
    <changeSet id="21" author="offer">
        <addForeignKeyConstraint baseColumnNames="REINSURER_ID" baseTableName="OFFER_REINSURER_LINK"
                                 constraintName="FK_OFFREI_ON_REINSURER" referencedColumnNames="ID"
                                 referencedTableName="REINSURER"/>
    </changeSet>
</databaseChangeLog>